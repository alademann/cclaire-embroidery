<h1 class="sixteen columns">{{ settings.text_shoppingcart }}</h1>
{% if cart.item_count == 0 %}
    <p class="sixteen columns">Your basket is empty</p>
    {% include 'notfound-products' %}
{% else %}
    <div class="sixteen columns">
        <script type="text/javascript">
        // <![CDATA[
            function remove_item(id) {
                if(confirm('Are you sure you want to remove this item?')) {
                    document.getElementById('updates_'+id).value = 0;
                    document.getElementById('cartform').submit();
                }
                return false;
            }
        // ]]>
        </script>
        <form action="/cart" method="post" id="cartform">
            <div id="basket" class="cf">
                <ul>
                {% for item in cart.items %}
                    <li>
                        <div class="cartitem cf">
                            <div class="image">
                                <a href="{{ item.product.url }}"><img src="{{ item.product.images.first | product_img_url: 'medium' }}" alt="{{ item.title | escape }}" /></a>
                            </div>
                            <div class="desc">
                                <span class="title"><a href="{{ item.product.url }}">{{ item.title }}</a></span>
                                <ul class="properties">
                                  {% for p in item.properties %}
                                   {% unless p.last == blank %}
                                    <li>{{ p.first }}:
                                        <strong>
                                         {% if p.last contains '/uploads/' %}
                                            <a class="lightbox" href="{{ p.last }}">{{ p.last | split: '/' | last }}</a>
                                         {% else %}
                                            {{ p.last }}
                                         {% endif %}
                                        </strong>
                                    </li>
                                   {% endunless %}
                                  {% endfor %}
                                </ul>
                                {% capture proddesc %}{% include 'process-html-strip' with item.product.description %}{% endcapture %}
                                <p class="long-desc">{{ proddesc | strip_html | truncate: 120 }}</p>
                            </div>
                            <div class="qty">
                                <label for="updates_{{ item.variant.id }}">Qty</label>
                                <!-- <input type="text" name="updates[]" id="updates_{{ item.id }}" value="{{ item.quantity }}" /> -->
                                {% unless settings.hide_plusmin_hide %}
                                <a href="javascript:modifyQuantity('#updates_{{ item.id }}', -1, {{ item.id }})" class="minibutton">-</a>
                                {% endunless %}
                                <input class="short" type="text" size="4" name="updates[]" id="updates_{{ item.id }}" value="{{ item.quantity }}" onfocus="this.select();">
                                {% unless settings.hide_plusmin_hide %}
                                <a href="javascript:modifyQuantity('#updates_{{ item.id }}', 1, {{ item.id }})" class="minibutton">+</a>
                                {% endunless %}
                            </div>
                            <div class="amt">
                                <span class="amount" id="row_amt_{{ item.variant.id }}">{{ item.line_price | money_with_currency }}
                                </span>
                            </div>
                            <div class="remove">
                                <a class="button remove" href="/cart/change?line={{ forloop.index }}&quantity=0" onclick="">Remove</a>
                            </div>
                        </div>
                    </li>
                {% endfor %}
                </ul>
                <div class="foot">
                    <div class="instructions">
                        {% unless settings.cart_hide_note %}
                            <p><a href="#note" id="shownote"><label for="note">{{ settings.text_telluscart }} &rarr;</label></a></p>
                            <textarea name="note" id="note" rows="3" cols="60">{{cart.note}}</textarea>
                            {% if cart.note && cart.note == '' %}
                            {% else %}
                                <script>
                                    $('#note').hide();
                                    $(function(){
                                        $(document).on('click', '#shownote', function(){
                                            $('#note').show(200);
                                            return false;
                                        });
                                    });
                                </script>
                            {% endif %}
                        {% endunless %}&nbsp;
                    </div>
                    <div class="updatecont"><input type="submit" class="button update altcolor" id="update-cart" name="update" value="Update" />&nbsp;</div>
                    <div class="checkoutcont">
                        <div class="total">{{ cart.total_price | money_with_currency }}</div>
                        <input type="submit" class="button large" name="checkout" value="{{ settings.text_checkout }}" />
                        {% if additional_checkout_buttons %}
                            <div class="extrapaymentmethods">
                                <p class="subtext">- or -</p>
                                {{ content_for_additional_checkout_buttons }}
                            </div>
                        {% endif %}
                    </div>
                    
                </div><!--/ .foot -->
            </div><!--/ #basket -->
        </form><!--/ #cartform -->
        {% include 'shipping-calculator' %}
    </div><!--/ .sixteen.columns -->
{% endif %}
